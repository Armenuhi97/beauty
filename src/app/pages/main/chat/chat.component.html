<div class="container m-0">

  <div class="row rounded-lg overflow-hidden shadow">

    <div class="col-5 px-0">
      <div class="bg-grey h-100">
        <div class="bg-gray px-4 py-2 bg-light">
          <p class="h5 mb-0 py-1">Recent</p>
        </div>
        <div [ngStyle]="{'height':windowHeight+'px'}" class="messages-box">
          <div class="list-group rounded-0">
            <ng-container *ngFor="let room of roomsList">
              <app-member-item (selectRoom)="setActiveRoom($event)" [room]="room"
                [active]="activeRoom?.room.id === room.room.id">
              </app-member-item>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
    <div class="col-7 px-0">
      <!--  [scrollTop]="scrollMe.scrollHeight"   [scrollTop]="scrollToTop(scrollMe.scrollHeight)"-->
      <div #scrollMe id="scrollMe" infiniteScroll [scrollTop]="scrollToTop(scrollMe.scrollHeight)"
        [infiniteScrollDistance]="2" [infiniteScrollThrottle]="10" (scrolledUp)="onScrollUp()" [scrollWindow]="false"
        [fromRoot]="false" [ngStyle]="{'height':windowHeight+'px'}" style="overflow:auto"
        class="px-4 py-5 chat-box bg-white">
        <ng-container *ngFor="let message of messages">
          <app-message-item [message]="message" [isIncoming]="message.replier_is_admin"></app-message-item>
        </ng-container>
      </div>
      <!-- Typing area -->
      <div class="form-control bg-light">
        <div class="d-flex action-button align-items-center justify-content-between" *ngIf="fileControl.value">
          <span>{{fileControl.value?.name}}</span> <i class="trash" (click)="deleteFile()" nz-icon nzType="delete"></i>
        </div>

        <div class="mesage-item align-items-start d-flex justify-content-between">

          <div class="d-flex align-items-center">
            <!-- <nz-upload class="upload" [nzShowUploadList]="false" (nzChange)="handleChange($event)"
              [nzHeaders]="{ authorization: 'authorization-text' }">
              <div class="d-flex align-items-center">
                <button nz-button><i nz-icon nzType="upload"></i></button>
              </div>
            </nz-upload> -->

            <nz-upload class="upload" [nzShowUploadList]="false" (nzChange)="handleChange($event)"
              [nzHeaders]="{ authorization: 'authorization-text' }">
              <div class="d-flex align-items-center">
                <button nz-button>

                  <div [class.success-icon]="fileControl.valid">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                      class="bi bi-upload" viewBox="0 0 16 16">
                      <path
                        d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                      <path
                        d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z" />
                    </svg>
                  </div>

                </button>

              </div>
            </nz-upload>
          </div>
          <div class="w-100">
            <textarea rows="3" [formControl]="messageControl" type="text" placeholder="Введите сообщение"
              class="form-control rounded-0 border-0 w-100 py-0 bg-light">
          </textarea>
          </div>
          <div class="d-flex">
            <button (click)="sendMessage()" type="submit" class="btn"
              [disabled]="messageControl.invalid && fileControl.invalid"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cursor-fill" viewBox="0 0 16 16">
                <path d="M14.082 2.182a.5.5 0 0 1 .103.557L8.528 15.467a.5.5 0 0 1-.917-.007L5.57 10.694.803 8.652a.5.5 0 0 1-.006-.916l12.728-5.657a.5.5 0 0 1 .556.103z"/>
              </svg></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>